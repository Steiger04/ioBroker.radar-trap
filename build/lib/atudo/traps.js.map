{
  "version": 3,
  "sources": ["../../../src/lib/atudo/traps.ts"],
  "sourcesContent": ["import { Feature, Point, point, Properties } from \"@turf/helpers\";\nimport { fetch } from \"cross-fetch\";\n\ntype Poi = {\n\tid: string;\n\tlat: string;\n\tlat_s: string;\n\tlng: string;\n\tlng_s: string;\n\tstreet: string;\n\tcontent: string;\n\tbackend: string;\n\ttype: string;\n\tvmax: string;\n\tcounter: string;\n\tcreate_date: string;\n\tconfirm_date: string;\n\tgps_status: string;\n\tinfo: string;\n\tpolyline: string;\n};\n\nconst trapBase = \"0,1,2,3,4,5,6,20,21,22,23,24,25,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,ts,vwd\";\n\nconst traps = async (\n\tminPos: { lng: number; lat: number },\n\tmaxPos: { lng: number; lat: number },\n): Promise<{\n\ttrapPoints: Feature<Point, Properties>[];\n\tpolyPoints: Feature<Point, Properties>[];\n}> => {\n\tconst { pois }: { pois: Poi[] } = await fetch(\n\t\t`https://cdn3.atudo.net/api/4.0/pois.php?type=${trapBase}&z=100&box=${minPos.lat},${minPos.lng},${maxPos.lat},${maxPos.lng}`,\n\t)\n\t\t.then((res) => res.json())\n\t\t.catch((ex) => console.log(ex));\n\n\tconst { polys } = await fetch(\n\t\t`https://cdn3.atudo.net/api/4.0/polylines.php?type=traffic&z=100&box=${minPos.lat},${minPos.lng},${maxPos.lat},${maxPos.lng}`,\n\t)\n\t\t.then((res) => res.json())\n\t\t.catch((ex) => console.log(ex));\n\n\tconst polyPoints = polys.reduce((list: Feature<Point, Properties>[], poly: any) => {\n\t\tlet polyPoint;\n\n\t\tif (poly.type === \"sc\") return list;\n\n\t\tif (poly.type === \"closure\") {\n\t\t\tpolyPoint = point<Properties>([+poly.pos.lng, +poly.pos.lat], {\n\t\t\t\t...poly,\n\t\t\t});\n\t\t} else {\n\t\t\tpolyPoint = point<Properties>([+poly.showdelay_pos.lng, +poly.showdelay_pos.lat], { ...poly });\n\t\t}\n\n\t\tlist.push(polyPoint);\n\n\t\treturn list;\n\t}, []);\n\n\tconst trapPoints = pois.reduce((list: Feature<Point, Properties>[], poi: Poi) => {\n\t\tconst trapPoint = point<Properties>([+poi.lng, +poi.lat]);\n\n\t\ttrapPoint.properties = poi;\n\t\tlist.push(trapPoint);\n\n\t\treturn list;\n\t}, []);\n\n\treturn { trapPoints, polyPoints };\n};\n\nexport { traps };\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAAkD;AAClD,yBAAsB;AAqBtB,MAAM,WAAW;AAEjB,MAAM,QAAQ,OACb,QACA,WAIK;AACL,QAAM,EAAE,KAAK,IAAqB,UAAM;AAAA,IACvC,gDAAgD,QAAQ,cAAc,OAAO,GAAG,IAAI,OAAO,GAAG,IAAI,OAAO,GAAG,IAAI,OAAO,GAAG;AAAA,EAC3H,EACE,KAAK,CAAC,QAAQ,IAAI,KAAK,CAAC,EACxB,MAAM,CAAC,OAAO,QAAQ,IAAI,EAAE,CAAC;AAE/B,QAAM,EAAE,MAAM,IAAI,UAAM;AAAA,IACvB,uEAAuE,OAAO,GAAG,IAAI,OAAO,GAAG,IAAI,OAAO,GAAG,IAAI,OAAO,GAAG;AAAA,EAC5H,EACE,KAAK,CAAC,QAAQ,IAAI,KAAK,CAAC,EACxB,MAAM,CAAC,OAAO,QAAQ,IAAI,EAAE,CAAC;AAE/B,QAAM,aAAa,MAAM,OAAO,CAAC,MAAoC,SAAc;AAClF,QAAI;AAEJ,QAAI,KAAK,SAAS;AAAM,aAAO;AAE/B,QAAI,KAAK,SAAS,WAAW;AAC5B,sBAAY,sBAAkB,CAAC,CAAC,KAAK,IAAI,KAAK,CAAC,KAAK,IAAI,GAAG,GAAG;AAAA,QAC7D,GAAG;AAAA,MACJ,CAAC;AAAA,IACF,OAAO;AACN,sBAAY,sBAAkB,CAAC,CAAC,KAAK,cAAc,KAAK,CAAC,KAAK,cAAc,GAAG,GAAG,EAAE,GAAG,KAAK,CAAC;AAAA,IAC9F;AAEA,SAAK,KAAK,SAAS;AAEnB,WAAO;AAAA,EACR,GAAG,CAAC,CAAC;AAEL,QAAM,aAAa,KAAK,OAAO,CAAC,MAAoC,QAAa;AAChF,UAAM,gBAAY,sBAAkB,CAAC,CAAC,IAAI,KAAK,CAAC,IAAI,GAAG,CAAC;AAExD,cAAU,aAAa;AACvB,SAAK,KAAK,SAAS;AAEnB,WAAO;AAAA,EACR,GAAG,CAAC,CAAC;AAEL,SAAO,EAAE,YAAY,WAAW;AACjC;",
  "names": []
}
