{
  "version": 3,
  "sources": ["../../src/lib/routeServiceListener.ts"],
  "sourcesContent": ["import { createRouteObjects } from \"./createRouteObjects\";\nimport { Scheduler } from \"./Scheduler\";\n\nimport type { Application } from \"@feathersjs/express\";\nimport type * as utils from \"@iobroker/adapter-core\";\nimport type { HookContext } from \"../server/app\";\n\nconst routeServiceListener = (\n\tthat: utils.AdapterInstance,\n\tfeathers: Application,\n): void => {\n\tfeathers\n\t\t.service(\"routes\")\n\t\t.on(\"status\", async (statusWithId: radarTrap.GenericStatusWithId) => {\n\t\t\tScheduler.setStatus(statusWithId);\n\t\t});\n\n\tfeathers.service(\"routes\").on(\"removed\", async (route: radarTrap.Route) => {\n\t\tawait that.deleteDeviceAsync(route._id);\n\n\t\tScheduler.delete(route._id);\n\t});\n\n\tfeathers\n\t\t.service(\"routes\")\n\t\t.on(\"created\", async (route: radarTrap.Route, ctx: HookContext) => {\n\t\t\tif (!ctx.params.patchSourceFromServer) {\n\t\t\t\tconst routeData = {\n\t\t\t\t\t_id: route._id,\n\t\t\t\t\tsrc: route.src,\n\t\t\t\t\tdst: route.dst,\n\t\t\t\t\tactiveProfile: route.activeProfile,\n\t\t\t\t\tmaxTrapDistance: route.maxTrapDistance,\n\t\t\t\t\tcron: route.cron,\n\t\t\t\t};\n\n\t\t\t\tScheduler.schedule(routeData, \"ROUTE\");\n\t\t\t}\n\n\t\t\tawait createRouteObjects(that, route);\n\t\t});\n};\n\nexport { routeServiceListener };\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gCAAmC;AACnC,uBAA0B;AAM1B,MAAM,uBAAuB,CAC5B,MACA,aACU;AACV,WACE,QAAQ,QAAQ,EAChB,GAAG,UAAU,OAAO,iBAAgD;AACpE,+BAAU,UAAU,YAAY;AAAA,EACjC,CAAC;AAEF,WAAS,QAAQ,QAAQ,EAAE,GAAG,WAAW,OAAO,UAA2B;AAC1E,UAAM,KAAK,kBAAkB,MAAM,GAAG;AAEtC,+BAAU,OAAO,MAAM,GAAG;AAAA,EAC3B,CAAC;AAED,WACE,QAAQ,QAAQ,EAChB,GAAG,WAAW,OAAO,OAAwB,QAAqB;AAClE,QAAI,CAAC,IAAI,OAAO,uBAAuB;AACtC,YAAM,YAAY;AAAA,QACjB,KAAK,MAAM;AAAA,QACX,KAAK,MAAM;AAAA,QACX,KAAK,MAAM;AAAA,QACX,eAAe,MAAM;AAAA,QACrB,iBAAiB,MAAM;AAAA,QACvB,MAAM,MAAM;AAAA,MACb;AAEA,iCAAU,SAAS,WAAW,OAAO;AAAA,IACtC;AAEA,cAAM,8CAAmB,MAAM,KAAK;AAAA,EACrC,CAAC;AACH;",
  "names": []
}
