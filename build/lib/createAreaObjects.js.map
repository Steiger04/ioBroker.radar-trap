{
  "version": 3,
  "sources": ["../../src/lib/createAreaObjects.ts"],
  "sourcesContent": ["import { Feature, Point } from \"@turf/turf\";\nimport { createCronJobAsync } from \"./createCronJob\";\n\nimport type * as utils from \"@iobroker/adapter-core\";\n\nconst createAreaObjects = async (that: utils.AdapterInstance, area: radarTrap.Area): Promise<void> => {\n\tawait that.setObjectAsync(area._id, {\n\t\ttype: \"device\",\n\t\tcommon: { name: area.description! },\n\t\tnative: { type: \"AREA\" },\n\t});\n\n\tawait createCronJobAsync(that, area._id);\n\n\tawait that.createChannelAsync(`${area._id}`, \"area-infos\", {\n\t\tname: \"Area Infos\",\n\t});\n\n\tawait that\n\t\t.createStateAsync(`${area._id}`, \"area-infos\", \"lastUpdated\", {\n\t\t\tname: \"Last Updated\",\n\t\t\tdefAck: true,\n\t\t\tread: true,\n\t\t\twrite: false,\n\t\t\ttype: \"string\",\n\t\t\trole: \"text\",\n\t\t})\n\t\t.then(() => that.setStateAsync(`${area._id}.area-infos.lastUpdated`, `${area.timestamp}`, true));\n\n\tawait that\n\t\t.createStateAsync(`${area._id}`, \"area-infos\", \"description\", {\n\t\t\tname: \"Description\",\n\t\t\tdefAck: true,\n\t\t\tread: true,\n\t\t\twrite: false,\n\t\t\ttype: \"string\",\n\t\t\trole: \"text\",\n\t\t})\n\t\t.then(() => that.setStateAsync(`${area._id}.area-infos.description`, `${area.description}`, true));\n\n\tawait that.createChannelAsync(`${area._id}`, \"area\", {\n\t\tname: \"Area\",\n\t});\n\n\t// for (const trapType of [\"areaTrapsNew\", \"areaTrapsEstablished\", \"areaTrapsRejected\"]) {\n\tfor (const trapType of [\"areaTraps\", \"areaTrapsNew\", \"areaTrapsRejected\"]) {\n\t\tlet totalTrapsCount = 0;\n\n\t\tfor (const [trapName, traps] of Object.entries(\n\t\t\tarea[trapType as keyof radarTrap.Area]! as Record<string, Feature<Point>[]>,\n\t\t)) {\n\t\t\tconst newTraps = traps\n\t\t\t\t.filter((trap) => trap.properties?.trapInfo !== null)\n\t\t\t\t.map((trap) => ({\n\t\t\t\t\ttype: trap.type,\n\t\t\t\t\tgeometry: trap.geometry,\n\t\t\t\t\tproperties: { ...trap.properties?.trapInfo },\n\t\t\t\t}));\n\n\t\t\ttotalTrapsCount += newTraps.length;\n\n\t\t\tawait that\n\t\t\t\t.createStateAsync(`${area._id}`, `area`, `${trapName}`, {\n\t\t\t\t\tname: `${trapName}`,\n\t\t\t\t\tdefAck: true,\n\t\t\t\t\tread: true,\n\t\t\t\t\twrite: false,\n\t\t\t\t\ttype: \"array\",\n\t\t\t\t\trole: \"list\",\n\t\t\t\t})\n\t\t\t\t.then(() => that.setStateAsync(`${area._id}.area.${trapName}`, JSON.stringify(newTraps), true));\n\n\t\t\tawait that\n\t\t\t\t.createStateAsync(`${area._id}`, `area`, `${trapName}Count`, {\n\t\t\t\t\tname: `${trapName} Count`,\n\t\t\t\t\tdefAck: true,\n\t\t\t\t\tread: true,\n\t\t\t\t\twrite: false,\n\t\t\t\t\ttype: \"number\",\n\t\t\t\t\trole: \"value\",\n\t\t\t\t})\n\t\t\t\t.then(() => that.setStateAsync(`${area._id}.area.${trapName}Count`, newTraps.length, true));\n\t\t}\n\n\t\tawait that\n\t\t\t.createStateAsync(`${area._id}`, \"area-infos\", `${trapType}Count`, {\n\t\t\t\tname: \"totalTraps Count\",\n\t\t\t\tdefAck: true,\n\t\t\t\tread: true,\n\t\t\t\twrite: false,\n\t\t\t\ttype: \"number\",\n\t\t\t\trole: \"value\",\n\t\t\t})\n\t\t\t.then(() => that.setStateAsync(`${area._id}.area-infos.${trapType}Count`, totalTrapsCount, true));\n\t}\n};\n\nexport { createAreaObjects };\n"],
  "mappings": "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",
  "names": []
}
