{
  "version": 3,
  "sources": ["../../src/lib/createAreaObjects.ts"],
  "sourcesContent": ["import { Feature, Point } from \"@turf/turf\";\nimport { createCronJobAsync } from \"./createCronJob\";\n\nconst createAreaObjects = async (that: ioBroker.AdapterInstanceWithI18n, area: radarTrap.Area): Promise<void> => {\n\tawait that.setObjectAsync(area._id, {\n\t\ttype: \"device\",\n\t\tcommon: { name: area.description! },\n\t\tnative: { type: \"AREA\" },\n\t});\n\n\tawait createCronJobAsync(that, area._id);\n\n\tawait that.createChannelAsync(`${area._id}`, \"area-infos\", {\n\t\tname: \"Area Infos\",\n\t});\n\n\tawait that\n\t\t.createStateAsync(`${area._id}`, \"area-infos\", \"lastUpdated\", {\n\t\t\tname: \"Last Updated\",\n\t\t\tdefAck: true,\n\t\t\tread: true,\n\t\t\twrite: false,\n\t\t\ttype: \"string\",\n\t\t\trole: \"text\",\n\t\t})\n\t\t.then(() => that.setStateAsync(`${area._id}.area-infos.lastUpdated`, `${area.timestamp}`, true));\n\n\tawait that\n\t\t.createStateAsync(`${area._id}`, \"area-infos\", \"description\", {\n\t\t\tname: \"Description\",\n\t\t\tdefAck: true,\n\t\t\tread: true,\n\t\t\twrite: false,\n\t\t\ttype: \"string\",\n\t\t\trole: \"text\",\n\t\t})\n\t\t.then(() => that.setStateAsync(`${area._id}.area-infos.description`, `${area.description}`, true));\n\n\t// for (const trapType of [\"areaTrapsNew\", \"areaTrapsEstablished\", \"areaTrapsRejected\"]) {\n\tfor (const trapType of [\"areaTraps\", \"areaTrapsEstablished\", \"areaTrapsNew\", \"areaTrapsRejected\"]) {\n\t\tlet totalTrapsCount = 0;\n\n\t\tlet channelName = \"\";\n\n\t\tswitch (trapType) {\n\t\t\tcase \"areaTraps\":\n\t\t\t\tchannelName = \"area-current\";\n\t\t\t\tbreak;\n\t\t\tcase \"areaTrapsNew\":\n\t\t\t\tchannelName = \"area-new\";\n\t\t\t\tbreak;\n\t\t\tcase \"areaTrapsRejected\":\n\t\t\t\tchannelName = \"area-rejected\";\n\t\t\t\tbreak;\n\t\t\tcase \"areaTrapsEstablished\":\n\t\t\t\tchannelName = \"area-established\";\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\tawait that.createChannelAsync(`${area._id}`, `${channelName}`, {\n\t\t\tname: \"Area\",\n\t\t});\n\n\t\tfor (const [trapName, traps] of Object.entries(\n\t\t\tarea[trapType as keyof radarTrap.Area] as Record<string, Feature<Point>[]>,\n\t\t)) {\n\t\t\tconst newTraps = traps.map((trap) => ({\n\t\t\t\ttype: trap.type,\n\t\t\t\tgeometry: trap.geometry,\n\t\t\t\tproperties: { ...trap.properties?.trapInfo },\n\t\t\t}));\n\n\t\t\ttotalTrapsCount += newTraps.length;\n\n\t\t\tawait that\n\t\t\t\t.createStateAsync(`${area._id}`, `${channelName}`, `${trapName}`, {\n\t\t\t\t\tname: that.I18n[trapName],\n\t\t\t\t\tdefAck: true,\n\t\t\t\t\tread: true,\n\t\t\t\t\twrite: false,\n\t\t\t\t\ttype: \"array\",\n\t\t\t\t\trole: \"list\",\n\t\t\t\t})\n\t\t\t\t.then(() =>\n\t\t\t\t\tthat.setStateAsync(`${area._id}.${channelName}.${trapName}`, JSON.stringify(newTraps), true),\n\t\t\t\t);\n\n\t\t\tawait that\n\t\t\t\t.createStateAsync(`${area._id}`, `${channelName}`, `${trapName}Count`, {\n\t\t\t\t\tname: `${that.I18n[\"count\"]}: ${that.I18n[trapName]}`,\n\t\t\t\t\tdefAck: true,\n\t\t\t\t\tread: true,\n\t\t\t\t\twrite: false,\n\t\t\t\t\ttype: \"number\",\n\t\t\t\t\trole: \"value\",\n\t\t\t\t})\n\t\t\t\t.then(() => that.setStateAsync(`${area._id}.${channelName}.${trapName}Count`, newTraps.length, true));\n\t\t}\n\n\t\tawait that\n\t\t\t.createStateAsync(`${area._id}`, \"area-infos\", `${trapType}Count`, {\n\t\t\t\tname: `${that.I18n[\"count\"]}: ${channelName}`,\n\t\t\t\tdefAck: true,\n\t\t\t\tread: true,\n\t\t\t\twrite: false,\n\t\t\t\ttype: \"number\",\n\t\t\t\trole: \"value\",\n\t\t\t})\n\t\t\t.then(() => that.setStateAsync(`${area._id}.area-infos.${trapType}Count`, totalTrapsCount, true));\n\t}\n};\n\nexport { createAreaObjects };\n"],
  "mappings": "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",
  "names": []
}
