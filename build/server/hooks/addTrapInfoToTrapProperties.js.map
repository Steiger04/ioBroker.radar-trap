{
  "version": 3,
  "sources": ["../../../src/server/hooks/addTrapInfoToTrapProperties.ts"],
  "sourcesContent": ["import type { Feature, LineString, Point } from \"@turf/helpers\";\n\nfunction isArray(it: any): boolean {\n\tif (typeof Array.isArray === \"function\") {\n\t\treturn Array.isArray(it);\n\t}\n\n\treturn Object.prototype.toString.call(it) === \"[object Array]\";\n}\n\nconst addTrapInfoToTrapProperties = (\n\ttraps: Record<string, Feature<Point | LineString, radarTrap.Poi>[]>,\n): Feature<Point | LineString, radarTrap.Poi>[] =>\n\tObject.values(traps).reduce(\n\t\t(list, t) => {\n\t\t\tif (isArray(t)) {\n\t\t\t\tt.forEach(({ properties }) => {\n\t\t\t\t\tconst trapInfo = {} as radarTrap.trapInfo;\n\n\t\t\t\t\ttrapInfo.id = properties!.backend;\n\t\t\t\t\ttrapInfo.status = properties!.status;\n\t\t\t\t\ttrapInfo.typeName = properties!.type_name;\n\n\t\t\t\t\tconst info = !properties.info ? false : (properties.info as radarTrap.PoiInfo);\n\n\t\t\t\t\tif (info !== false) {\n\t\t\t\t\t\ttrapInfo.reason = info.reason || properties.reason;\n\t\t\t\t\t\t// trapInfo.length = info.length > 0 && info.length;\n\t\t\t\t\t\ttrapInfo.duration = Boolean(info.duration) && Math.round(Number(info.duration) / 60);\n\t\t\t\t\t\ttrapInfo.delay = Boolean(info.delay) && Math.round(Number(info.delay) / 60);\n\n\t\t\t\t\t\ttrapInfo.createDate = properties!.create_date !== \"01.01.1970\" && properties!.create_date;\n\t\t\t\t\t\ttrapInfo.confirmDate = properties!.confirm_date !== \"01.01.1970\" && properties!.confirm_date;\n\n\t\t\t\t\t\ttrapInfo.vmax =\n\t\t\t\t\t\t\tBoolean(properties!.vmax) &&\n\t\t\t\t\t\t\tproperties!.vmax !== \"?\" &&\n\t\t\t\t\t\t\tproperties!.vmax !== \"/\" &&\n\t\t\t\t\t\t\tproperties!.vmax;\n\t\t\t\t\t\ttrapInfo.typeText = Boolean(properties!.type_text) && properties!.type_text;\n\t\t\t\t\t\ttrapInfo.country = Boolean(properties!.address.country) && properties!.address.country;\n\t\t\t\t\t\ttrapInfo.state = Boolean(properties!.address.state) && properties!.address.state;\n\t\t\t\t\t\ttrapInfo.zipCode = Boolean(properties!.address.zip_code) && properties!.address.zip_code;\n\t\t\t\t\t\ttrapInfo.city = Boolean(properties!.address.city) && properties!.address.city;\n\t\t\t\t\t\ttrapInfo.cityDistrict =\n\t\t\t\t\t\t\tBoolean(properties!.address.city_district) && properties!.address.city_district;\n\t\t\t\t\t\ttrapInfo.street = Boolean(properties!.address.street) && properties!.address.street;\n\n\t\t\t\t\t\tproperties!.trapInfo = trapInfo; // properties are mutable\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tconst lineTraps = t\n\t\t\t\t\t.filter((obj) => obj.properties.polyline !== \"\")\n\t\t\t\t\t.map((obj) => {\n\t\t\t\t\t\tconst lt = obj.properties.polyline as Feature<LineString, radarTrap.Poi>;\n\n\t\t\t\t\t\tlt.properties.trapInfo = {};\n\t\t\t\t\t\tlt.properties.status = obj.properties?.status;\n\n\t\t\t\t\t\treturn lt;\n\t\t\t\t\t});\n\n\t\t\t\treturn [...list, ...t, ...lineTraps];\n\t\t\t}\n\n\t\t\treturn list;\n\t\t},\n\t\t[] as Feature<Point | LineString, radarTrap.Poi>[],\n\t);\n\nexport { addTrapInfoToTrapProperties };\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,SAAS,QAAQ,IAAkB;AAClC,MAAI,OAAO,MAAM,YAAY,YAAY;AACxC,WAAO,MAAM,QAAQ,EAAE;AAAA,EACxB;AAEA,SAAO,OAAO,UAAU,SAAS,KAAK,EAAE,MAAM;AAC/C;AAEA,MAAM,8BAA8B,CACnC,UAEA,OAAO,OAAO,KAAK,EAAE;AAAA,EACpB,CAAC,MAAM,MAAM;AACZ,QAAI,QAAQ,CAAC,GAAG;AACf,QAAE,QAAQ,CAAC,EAAE,WAAW,MAAM;AAC7B,cAAM,WAAW,CAAC;AAElB,iBAAS,KAAK,WAAY;AAC1B,iBAAS,SAAS,WAAY;AAC9B,iBAAS,WAAW,WAAY;AAEhC,cAAM,OAAO,CAAC,WAAW,OAAO,QAAS,WAAW;AAEpD,YAAI,SAAS,OAAO;AACnB,mBAAS,SAAS,KAAK,UAAU,WAAW;AAE5C,mBAAS,WAAW,QAAQ,KAAK,QAAQ,KAAK,KAAK,MAAM,OAAO,KAAK,QAAQ,IAAI,EAAE;AACnF,mBAAS,QAAQ,QAAQ,KAAK,KAAK,KAAK,KAAK,MAAM,OAAO,KAAK,KAAK,IAAI,EAAE;AAE1E,mBAAS,aAAa,WAAY,gBAAgB,gBAAgB,WAAY;AAC9E,mBAAS,cAAc,WAAY,iBAAiB,gBAAgB,WAAY;AAEhF,mBAAS,OACR,QAAQ,WAAY,IAAI,KACxB,WAAY,SAAS,OACrB,WAAY,SAAS,OACrB,WAAY;AACb,mBAAS,WAAW,QAAQ,WAAY,SAAS,KAAK,WAAY;AAClE,mBAAS,UAAU,QAAQ,WAAY,QAAQ,OAAO,KAAK,WAAY,QAAQ;AAC/E,mBAAS,QAAQ,QAAQ,WAAY,QAAQ,KAAK,KAAK,WAAY,QAAQ;AAC3E,mBAAS,UAAU,QAAQ,WAAY,QAAQ,QAAQ,KAAK,WAAY,QAAQ;AAChF,mBAAS,OAAO,QAAQ,WAAY,QAAQ,IAAI,KAAK,WAAY,QAAQ;AACzE,mBAAS,eACR,QAAQ,WAAY,QAAQ,aAAa,KAAK,WAAY,QAAQ;AACnE,mBAAS,SAAS,QAAQ,WAAY,QAAQ,MAAM,KAAK,WAAY,QAAQ;AAE7E,qBAAY,WAAW;AAAA,QACxB;AAAA,MACD,CAAC;AAED,YAAM,YAAY,EAChB,OAAO,CAAC,QAAQ,IAAI,WAAW,aAAa,EAAE,EAC9C,IAAI,CAAC,QAAQ;AAtDnB;AAuDM,cAAM,KAAK,IAAI,WAAW;AAE1B,WAAG,WAAW,WAAW,CAAC;AAC1B,WAAG,WAAW,UAAS,SAAI,eAAJ,mBAAgB;AAEvC,eAAO;AAAA,MACR,CAAC;AAEF,aAAO,CAAC,GAAG,MAAM,GAAG,GAAG,GAAG,SAAS;AAAA,IACpC;AAEA,WAAO;AAAA,EACR;AAAA,EACA,CAAC;AACF;",
  "names": []
}
