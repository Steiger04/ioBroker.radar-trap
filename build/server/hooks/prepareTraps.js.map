{
  "version": 3,
  "sources": ["../../../src/server/hooks/prepareTraps.ts"],
  "sourcesContent": ["import type { Feature, LineString, Point, Properties } from \"@turf/helpers\";\n\nfunction isArray(it: any): boolean {\n\tif (typeof Array.isArray === \"function\") {\n\t\treturn Array.isArray(it);\n\t}\n\n\treturn Object.prototype.toString.call(it) === \"[object Array]\";\n}\n\nconst prepareTraps = (\n\ttraps: Record<string, Feature<Point | LineString, Properties>[]>,\n): Feature<Point | LineString, Properties>[] =>\n\tObject.values(traps).reduce((list, t) => {\n\t\tif (isArray(t)) {\n\t\t\tt.forEach(({ properties }) => {\n\t\t\t\tconst trapInfo = {} as radarTrap.trapInfo;\n\n\t\t\t\ttrapInfo.id = properties!.backend;\n\t\t\t\ttrapInfo.status = properties!.status;\n\t\t\t\ttrapInfo.typeName = properties!.type_name;\n\n\t\t\t\tconst info = properties!.info === \"false\" ? false : properties!.info;\n\n\t\t\t\ttrapInfo.reason =\n\t\t\t\t\t(Boolean(info) && Boolean(info.reason) && info.reason) ||\n\t\t\t\t\t(Boolean(properties!.reason) && properties!.reason);\n\t\t\t\ttrapInfo.length = Boolean(info) && info.length > 0 && info.length;\n\t\t\t\ttrapInfo.duration = Boolean(info) && Boolean(info.duration) && Math.round(Number(info.duration) / 60);\n\t\t\t\ttrapInfo.delay = Boolean(info) && Boolean(info.delay) && Math.round(Number(info.delay) / 60);\n\n\t\t\t\ttrapInfo.createDate = properties!.create_date !== \"01.01.1970\" && properties!.create_date;\n\t\t\t\ttrapInfo.confirmDate = properties!.confirm_date !== \"01.01.1970\" && properties!.confirm_date;\n\n\t\t\t\ttrapInfo.vmax =\n\t\t\t\t\tBoolean(properties!.vmax) &&\n\t\t\t\t\tproperties!.vmax !== \"?\" &&\n\t\t\t\t\tproperties!.vmax !== \"/\" &&\n\t\t\t\t\tproperties!.vmax;\n\t\t\t\ttrapInfo.typeText = Boolean(properties!.type_text) && properties!.type_text;\n\t\t\t\ttrapInfo.country = Boolean(properties!.address.country) && properties!.address.country;\n\t\t\t\ttrapInfo.state = Boolean(properties!.address.state) && properties!.address.state;\n\t\t\t\ttrapInfo.zipCode = Boolean(properties!.address.zip_code) && properties!.address.zip_code;\n\t\t\t\ttrapInfo.city = Boolean(properties!.address.city) && properties!.address.city;\n\t\t\t\ttrapInfo.cityDistrict = Boolean(properties!.address.city_district) && properties!.address.city_district;\n\t\t\t\ttrapInfo.street = Boolean(properties!.address.street) && properties!.address.street;\n\n\t\t\t\tproperties!.trapInfo = trapInfo;\n\t\t\t});\n\n\t\t\tconst lineTraps = t\n\t\t\t\t.filter((obj) => obj.properties?.polyline !== \"\")\n\t\t\t\t.map((obj) => {\n\t\t\t\t\tconst lt = obj.properties?.polyline;\n\n\t\t\t\t\tlt.properties.trapInfo = null;\n\n\t\t\t\t\treturn lt;\n\t\t\t\t});\n\n\t\t\treturn [...list, ...t, ...lineTraps];\n\t\t}\n\n\t\treturn list;\n\t}, []);\n\nexport { prepareTraps };\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,SAAS,QAAQ,IAAkB;AAClC,MAAI,OAAO,MAAM,YAAY,YAAY;AACxC,WAAO,MAAM,QAAQ,EAAE;AAAA,EACxB;AAEA,SAAO,OAAO,UAAU,SAAS,KAAK,EAAE,MAAM;AAC/C;AAEA,MAAM,eAAe,CACpB,UAEA,OAAO,OAAO,KAAK,EAAE,OAAO,CAAC,MAAM,MAAM;AACxC,MAAI,QAAQ,CAAC,GAAG;AACf,MAAE,QAAQ,CAAC,EAAE,WAAW,MAAM;AAC7B,YAAM,WAAW,CAAC;AAElB,eAAS,KAAK,WAAY;AAC1B,eAAS,SAAS,WAAY;AAC9B,eAAS,WAAW,WAAY;AAEhC,YAAM,OAAO,WAAY,SAAS,UAAU,QAAQ,WAAY;AAEhE,eAAS,SACP,QAAQ,IAAI,KAAK,QAAQ,KAAK,MAAM,KAAK,KAAK,UAC9C,QAAQ,WAAY,MAAM,KAAK,WAAY;AAC7C,eAAS,SAAS,QAAQ,IAAI,KAAK,KAAK,SAAS,KAAK,KAAK;AAC3D,eAAS,WAAW,QAAQ,IAAI,KAAK,QAAQ,KAAK,QAAQ,KAAK,KAAK,MAAM,OAAO,KAAK,QAAQ,IAAI,EAAE;AACpG,eAAS,QAAQ,QAAQ,IAAI,KAAK,QAAQ,KAAK,KAAK,KAAK,KAAK,MAAM,OAAO,KAAK,KAAK,IAAI,EAAE;AAE3F,eAAS,aAAa,WAAY,gBAAgB,gBAAgB,WAAY;AAC9E,eAAS,cAAc,WAAY,iBAAiB,gBAAgB,WAAY;AAEhF,eAAS,OACR,QAAQ,WAAY,IAAI,KACxB,WAAY,SAAS,OACrB,WAAY,SAAS,OACrB,WAAY;AACb,eAAS,WAAW,QAAQ,WAAY,SAAS,KAAK,WAAY;AAClE,eAAS,UAAU,QAAQ,WAAY,QAAQ,OAAO,KAAK,WAAY,QAAQ;AAC/E,eAAS,QAAQ,QAAQ,WAAY,QAAQ,KAAK,KAAK,WAAY,QAAQ;AAC3E,eAAS,UAAU,QAAQ,WAAY,QAAQ,QAAQ,KAAK,WAAY,QAAQ;AAChF,eAAS,OAAO,QAAQ,WAAY,QAAQ,IAAI,KAAK,WAAY,QAAQ;AACzE,eAAS,eAAe,QAAQ,WAAY,QAAQ,aAAa,KAAK,WAAY,QAAQ;AAC1F,eAAS,SAAS,QAAQ,WAAY,QAAQ,MAAM,KAAK,WAAY,QAAQ;AAE7E,iBAAY,WAAW;AAAA,IACxB,CAAC;AAED,UAAM,YAAY,EAChB,OAAO,CAAC,QAAK;AAnDlB;AAmDqB,wBAAI,eAAJ,mBAAgB,cAAa;AAAA,KAAE,EAC/C,IAAI,CAAC,QAAQ;AApDlB;AAqDK,YAAM,MAAK,SAAI,eAAJ,mBAAgB;AAE3B,SAAG,WAAW,WAAW;AAEzB,aAAO;AAAA,IACR,CAAC;AAEF,WAAO,CAAC,GAAG,MAAM,GAAG,GAAG,GAAG,SAAS;AAAA,EACpC;AAEA,SAAO;AACR,GAAG,CAAC,CAAC;",
  "names": []
}
