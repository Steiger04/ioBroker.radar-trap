{
  "version": 3,
  "sources": ["../../../src/server/hooks/prepareTraps.ts"],
  "sourcesContent": ["import type { Feature, LineString, Point, Properties } from \"@turf/helpers\";\n\nfunction isArray(it: any): boolean {\n\tif (typeof Array.isArray === \"function\") {\n\t\treturn Array.isArray(it);\n\t}\n\n\treturn Object.prototype.toString.call(it) === \"[object Array]\";\n}\n\nconst prepareTraps = (\n\ttraps: Record<string, Feature<Point | LineString, Properties>[]>,\n): Feature<Point | LineString, Properties>[] =>\n\tObject.values(traps).reduce((list, t) => {\n\t\tif (isArray(t)) {\n\t\t\tt.forEach(({ properties }) => {\n\t\t\t\tconst trapInfo = {} as radarTrap.trapInfo;\n\n\t\t\t\ttrapInfo.typeName = properties!.type_name;\n\n\t\t\t\tconst info =\n\t\t\t\t\tproperties!.info === \"false\" ? false : properties!.info;\n\n\t\t\t\ttrapInfo.reason =\n\t\t\t\t\t(Boolean(info) && Boolean(info.reason) && info.reason) ||\n\t\t\t\t\t(Boolean(properties!.reason) && properties!.reason);\n\t\t\t\ttrapInfo.length =\n\t\t\t\t\tBoolean(info) && info.length > 0 && info.length;\n\t\t\t\ttrapInfo.duration =\n\t\t\t\t\tBoolean(info) &&\n\t\t\t\t\tBoolean(info.duration) &&\n\t\t\t\t\tMath.round(Number(info.duration) / 60);\n\t\t\t\ttrapInfo.delay =\n\t\t\t\t\tBoolean(info) &&\n\t\t\t\t\tBoolean(info.delay) &&\n\t\t\t\t\tMath.round(Number(info.delay) / 60);\n\n\t\t\t\ttrapInfo.createDate =\n\t\t\t\t\tproperties!.create_date !== \"01.01.1970\" &&\n\t\t\t\t\tproperties!.create_date;\n\t\t\t\ttrapInfo.confirmDate =\n\t\t\t\t\tproperties!.confirm_date !== \"01.01.1970\" &&\n\t\t\t\t\tproperties!.confirm_date;\n\n\t\t\t\ttrapInfo.vmax =\n\t\t\t\t\tBoolean(properties!.vmax) &&\n\t\t\t\t\tproperties!.vmax !== \"?\" &&\n\t\t\t\t\tproperties!.vmax !== \"/\" &&\n\t\t\t\t\tproperties!.vmax;\n\t\t\t\ttrapInfo.typeText =\n\t\t\t\t\tBoolean(properties!.type_text) && properties!.type_text;\n\t\t\t\ttrapInfo.country =\n\t\t\t\t\tBoolean(properties!.address.country) &&\n\t\t\t\t\tproperties!.address.country;\n\t\t\t\ttrapInfo.state =\n\t\t\t\t\tBoolean(properties!.address.state) &&\n\t\t\t\t\tproperties!.address.state;\n\t\t\t\ttrapInfo.zipCode =\n\t\t\t\t\tBoolean(properties!.address.zip_code) &&\n\t\t\t\t\tproperties!.address.zip_code;\n\t\t\t\ttrapInfo.city =\n\t\t\t\t\tBoolean(properties!.address.city) &&\n\t\t\t\t\tproperties!.address.city;\n\t\t\t\ttrapInfo.cityDistrict =\n\t\t\t\t\tBoolean(properties!.address.city_district) &&\n\t\t\t\t\tproperties!.address.city_district;\n\t\t\t\ttrapInfo.street =\n\t\t\t\t\tBoolean(properties!.address.street) &&\n\t\t\t\t\tproperties!.address.street;\n\n\t\t\t\tproperties!.trapInfo = trapInfo;\n\t\t\t});\n\n\t\t\tconst lineTraps = t\n\t\t\t\t.filter((obj) => obj.properties?.polyline !== \"\")\n\t\t\t\t.map((obj) => {\n\t\t\t\t\tconst lt = obj.properties?.polyline;\n\n\t\t\t\t\tlt.properties.trapInfo = null;\n\n\t\t\t\t\treturn lt;\n\t\t\t\t});\n\n\t\t\treturn [...list, ...t, ...lineTraps];\n\t\t}\n\n\t\treturn list;\n\t}, []);\n\nexport { prepareTraps };\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,SAAS,QAAQ,IAAkB;AAClC,MAAI,OAAO,MAAM,YAAY,YAAY;AACxC,WAAO,MAAM,QAAQ,EAAE;AAAA,EACxB;AAEA,SAAO,OAAO,UAAU,SAAS,KAAK,EAAE,MAAM;AAC/C;AAEA,MAAM,eAAe,CACpB,UAEA,OAAO,OAAO,KAAK,EAAE,OAAO,CAAC,MAAM,MAAM;AACxC,MAAI,QAAQ,CAAC,GAAG;AACf,MAAE,QAAQ,CAAC,EAAE,WAAW,MAAM;AAC7B,YAAM,WAAW,CAAC;AAElB,eAAS,WAAW,WAAY;AAEhC,YAAM,OACL,WAAY,SAAS,UAAU,QAAQ,WAAY;AAEpD,eAAS,SACP,QAAQ,IAAI,KAAK,QAAQ,KAAK,MAAM,KAAK,KAAK,UAC9C,QAAQ,WAAY,MAAM,KAAK,WAAY;AAC7C,eAAS,SACR,QAAQ,IAAI,KAAK,KAAK,SAAS,KAAK,KAAK;AAC1C,eAAS,WACR,QAAQ,IAAI,KACZ,QAAQ,KAAK,QAAQ,KACrB,KAAK,MAAM,OAAO,KAAK,QAAQ,IAAI,EAAE;AACtC,eAAS,QACR,QAAQ,IAAI,KACZ,QAAQ,KAAK,KAAK,KAClB,KAAK,MAAM,OAAO,KAAK,KAAK,IAAI,EAAE;AAEnC,eAAS,aACR,WAAY,gBAAgB,gBAC5B,WAAY;AACb,eAAS,cACR,WAAY,iBAAiB,gBAC7B,WAAY;AAEb,eAAS,OACR,QAAQ,WAAY,IAAI,KACxB,WAAY,SAAS,OACrB,WAAY,SAAS,OACrB,WAAY;AACb,eAAS,WACR,QAAQ,WAAY,SAAS,KAAK,WAAY;AAC/C,eAAS,UACR,QAAQ,WAAY,QAAQ,OAAO,KACnC,WAAY,QAAQ;AACrB,eAAS,QACR,QAAQ,WAAY,QAAQ,KAAK,KACjC,WAAY,QAAQ;AACrB,eAAS,UACR,QAAQ,WAAY,QAAQ,QAAQ,KACpC,WAAY,QAAQ;AACrB,eAAS,OACR,QAAQ,WAAY,QAAQ,IAAI,KAChC,WAAY,QAAQ;AACrB,eAAS,eACR,QAAQ,WAAY,QAAQ,aAAa,KACzC,WAAY,QAAQ;AACrB,eAAS,SACR,QAAQ,WAAY,QAAQ,MAAM,KAClC,WAAY,QAAQ;AAErB,iBAAY,WAAW;AAAA,IACxB,CAAC;AAED,UAAM,YAAY,EAChB,OAAO,CAAC,QAAK;AA1ElB;AA0EqB,wBAAI,eAAJ,mBAAgB,cAAa;AAAA,KAAE,EAC/C,IAAI,CAAC,QAAQ;AA3ElB;AA4EK,YAAM,MAAK,SAAI,eAAJ,mBAAgB;AAE3B,SAAG,WAAW,WAAW;AAEzB,aAAO;AAAA,IACR,CAAC;AAEF,WAAO,CAAC,GAAG,MAAM,GAAG,GAAG,GAAG,SAAS;AAAA,EACpC;AAEA,SAAO;AACR,GAAG,CAAC,CAAC;",
  "names": []
}
